function doGet() {
  try {
    var ss = SpreadsheetApp.openById("1tSyP-pI4EY0sGAGdFTnV2BogkzWHL-DIyDkvpbrucmw"); // your sheet ID
    var dealsSheet = ss.getSheetByName("Deals"); // make sure the tab is exactly "Deals"
    var data = dealsSheet.getDataRange().getValues();
    var headers = data.shift();

    var output = data.map(function(row) {
      var obj = {};
      headers.forEach(function(h, i) {
        obj[h] = row[i];
      });
      return obj;
    });

    return ContentService
      .createTextOutput(JSON.stringify(output))
      .setMimeType(ContentService.MimeType.JSON);

  } catch (e) {
    return ContentService
      .createTextOutput(JSON.stringify({ error: e.message }))
      .setMimeType(ContentService.MimeType.JSON);
  }
}