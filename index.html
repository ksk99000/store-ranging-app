<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>üì± Store Ranging App</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; background: #f8f9fa; }
    h1 { color: #007bff; }
    select, button { padding: 8px; margin: 5px; }
    #debug { white-space: pre-wrap; background: #fff3cd; padding: 10px; border-radius: 5px; margin-top: 10px; }
    .error { color: red; }
    .success { color: green; }
    .version { font-size: 0.8em; color: gray; }
  </style>
</head>
<body>
  <h1>üì± Store Ranging App <span class="version">v2.3.0 (17 Sept 2025)</span></h1>

  <button onclick="loadData()">üîÑ Refresh</button>
  <select id="storeSelect">
    <option>-- Select a store --</option>
  </select>

  <h2>Products</h2>
  <div id="products"></div>

  <h3>üõ†Ô∏è Debug Output</h3>
  <div id="debug">Waiting for data‚Ä¶</div>

  <script>
    const API_URL = "https://script.google.com/macros/s/AKfycbwX05hFhJaGxwQl6X_ifm66MUb-PBBAfvvsQzSnUFQiS3lG-0dSdqN3ddzDYgP2st_OTw/exec";

    function loadData() {
      document.getElementById("debug").textContent = "Loading...";
      fetch(API_URL)
        .then(response => response.json())
        .then(data => {
          if (!data.success) {
            document.getElementById("debug").innerHTML =
              "<pre class='error'>" + JSON.stringify(data, null, 2) + "</pre>";
            return;
          }

          // ‚úÖ Show debug
          document.getElementById("debug").innerHTML =
            "<pre class='success'>" + JSON.stringify(data, null, 2) + "</pre>";

          // ‚úÖ Populate store dropdown
          if (data.sampleData && data.sampleData.StoreLocations) {
            const storeSelect = document.getElementById("storeSelect");
            storeSelect.innerHTML = "<option>-- Select a store --</option>";
            data.sampleData.StoreLocations.forEach(row => {
              if (row[0] && row[0] !== "Store ID") {
                storeSelect.innerHTML += `<option value="${row[0]}">${row[1]}</option>`;
              }
            });
          }
        })
        .catch(err => {
          document.getElementById("debug").innerHTML =
            "<pre class='error'>Fetch error: " + err + "</pre>";
        });
    }

    // Auto-load on start
    loadData();
  </script>
</body>
</html>